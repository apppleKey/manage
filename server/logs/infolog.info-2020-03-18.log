[2020-03-18T18:46:04.093] [INFO] info - server running  8989port....
[2020-03-18T19:03:32.543] [INFO] info - server running  8989port....
[2020-03-18T19:05:58.487] [INFO] info - server running  8989port....
[2020-03-18T19:35:02.748] [INFO] info - server running  8989port....
[2020-03-18T19:37:05.730] [INFO] info - server running  8989port....
[2020-03-18T19:38:24.319] [INFO] info - server running  8989port....
[2020-03-18T19:42:29.124] [INFO] info - server running  8989port....
[2020-03-18T19:44:11.330] [INFO] info - server running  8989port....
[2020-03-18T19:45:14.047] [INFO] info - server running  8989port....
[2020-03-18T19:46:42.617] [INFO] info - server running  8989port....
[2020-03-18T19:47:31.083] [INFO] info - server running  8989port....
[2020-03-18T19:48:41.874] [INFO] info - server running  8989port....
[2020-03-18T19:50:54.439] [INFO] info - server running  8989port....
[2020-03-18T20:01:38.284] [INFO] info - server running  8989port....
[2020-03-18T20:01:52.217] [INFO] info - server running  8989port....
[2020-03-18T20:04:05.130] [INFO] info - server running  8989port....
[2020-03-18T20:11:32.626] [INFO] info - /api/note/edit POST [Object: null prototype] {
  details:
   '<h1 class="_1RuRku" style="margin-top: 0px; margin-bottom: 0.5em; color: rgb(64, 64, 64); text-rendering: optimizelegibility; font-size: 30px; word-break: break-word; font-family: -apple-system, BlinkMacSystemFont, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;">node使用express+multer文件上传和下载的问题</h1><div class="rEsl9f" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; font-size: 13px; color: rgb(64, 64, 64); font-family: -apple-system, BlinkMacSystemFont, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><div class="_2mYfmT" style="display: flex; align-items: center;"><a class="_1OhGeD" href="https://www.jianshu.com/u/53414b1c6172" target="_blank" rel="noopener noreferrer" style="background-color: transparent; outline: none; cursor: pointer; transition: color 0.3s ease 0s; touch-action: manipulation;"><img class="_13D2Eh" src="https://upload.jianshu.io/users/upload_avatars/6367404/2d4b8f66-53c1-46a6-a964-205ae1033145?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96/format/webp" alt="" style="vertical-align: middle; border: 1px solid rgb(238, 238, 238); display: block; border-radius: 50%; min-width: 48px; min-height: 48px; width: 48px; height: 48px;"></a><div style="margin-left: 8px;"><div class="_3U4Smb" style="display: flex; align-items: center; margin-bottom: 6px;"><span class="FxYr8x" style="font-size: 16px; margin-right: 8px;"><a class="_1OhGeD" href="https://www.jianshu.com/u/53414b1c6172" target="_blank" rel="noopener noreferrer" style="background-color: transparent; outline: none; cursor: pointer; transition: color 0.3s ease 0s; touch-action: manipulation;">东东丶酱</a></span><button data-locale="zh-CN" type="button" class="_3kba3h _1OyPqC _3Mi9q9 _34692-" style="touch-action: manipulation; margin: 0px; color: rgb(236, 114, 89); font-size: 12px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: relative; flex-shrink: 0; display: inline-flex; justify-content: center; align-items: center; border-radius: 50px; background-image: none; white-space: nowrap; transition: all 0.2s cubic-bezier(0.645, 0.045, 0.355, 1) 0s; padding: 2px 9px; background-color: rgb(255, 255, 255); border-width: 1px; border-style: solid; border-color: rgb(236, 114, 89);">关注</button></div><div class="s-dsoj" style="display: flex; color: rgb(150, 150, 150);"><span class="_3tCVn5" style="display: inline-flex; align-items: center; justify-content: center; color: rgb(236, 114, 89); margin-right: 10px;"><span aria-label="ic-diamond" class="anticon" style="display: inline-block; color: inherit; line-height: 0; text-align: center; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased; margin-right: 0.5em;"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#ic-diamond"><svg id="ic-diamond" viewBox="0 0 1026 1024"><path d="M751.144277 307.2l-123.016533-238.933333h159.778133a81.92 81.92 0 0 1 59.1872 25.258666l160.256 167.492267A27.306667 27.306667 0 0 1 987.620011 307.2h-236.475734z m270.506667 111.547733L640.927744 946.039467a27.306667 27.306667 0 0 1-48.128-24.234667L766.504277 375.466667h-56.388266l-170.5984 590.165333a27.306667 27.306667 0 0 1-52.462934 0.034133L315.500544 375.466667H259.112277l174.523734 545.5872a27.306667 27.306667 0 0 1-48.128 24.302933L5.160277 418.747733A27.306667 27.306667 0 0 1 27.346944 375.466667H999.464277a27.306667 27.306667 0 0 1 22.152534 43.281066zM18.301611 261.0176L178.557611 93.525333A81.92 81.92 0 0 1 237.744811 68.266667h159.744L274.506411 307.2H38.030677a27.306667 27.306667 0 0 1-19.729066-46.1824zM453.877077 68.266667h117.896534l122.9824 238.933333H330.894677l122.9824-238.933333z"></path></svg></use></svg></span>0.644</span><time datetime="2018-09-12T03:29:08.000Z" style="margin-right: 10px;">2018.09.12 11:29:08</time><span style="margin-right: 10px;">字数 413</span>阅读 6,568</div></div></div></div><article class="_2rhmJa" style="line-height: 1.8; margin-bottom: 20px; color: rgb(64, 64, 64); font-family: -apple-system, BlinkMacSystemFont, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px;"><h1 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 26px;">简单使用multer实现文件的上传和下载；</h1><h2 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 24px;">1、文件上传使用multer，首先要在项目中安装multer模块。</h2><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-undefined" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-undefined" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;">npm install multer -save\n<span aria-hidden="true" class="line-numbers-rows" style="position: absolute; pointer-events: none; top: 0px; left: -3.8em; width: 3em; letter-spacing: -1px; border-right: 1px solid rgb(153, 153, 153); user-select: none;"><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span></span></code></pre></div><h2 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 24px;">2、这里使用express模块,multer文件上传分为单文件和多文件，单文件使用如下；</h2><h4 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 20px;">（1）客户端代码,这里我们简单使用form表单提交，使用post方式，表单一定要设置enctype="multipart/form-data",否则会有意想不到的错误。</h4><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-xml" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-xml" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;"><span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>h1</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>文件上传<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;/</span>h1</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>/<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">method</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>post<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>multipart/form-data<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n    <span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>files<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">type</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>file<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">name</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>file<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation" style="color: rgb(204, 204, 204);">/&gt;</span></span> <span class="token comment" style="color: rgb(153, 153, 153);">&lt;!-- 这里的multiple属性是允许多文件上传的，单文件上传可以不写此属性（最好都写上）--&gt;</span>\n    <span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>submit<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">value</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>上传<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span><span class="token punctuation" style="color: rgb(204, 204, 204);">/&gt;</span></span>\n<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;/</span>form</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n<span aria-hidden="true" class="line-numbers-rows" style="position: absolute; pointer-events: none; top: 0px; left: -3.8em; width: 3em; letter-spacing: -1px; border-right: 1px solid rgb(153, 153, 153); user-select: none;"><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span></span></code></pre></div><h4 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 20px;">（2）客户端到这里就可以了，下面进行服务端配置，单文件要是用，single("在这里写表单里的name值")</h4><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-jsx" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-jsx" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;"><span class="token keyword" style="color: rgb(204, 153, 205);">let</span> express <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token function" style="color: rgb(240, 141, 73);">require</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'express\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword" style="color: rgb(204, 153, 205);">let</span> multer <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token function" style="color: rgb(240, 141, 73);">require</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'multer\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword" style="color: rgb(204, 153, 205);">let</span> fs <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token function" style="color: rgb(240, 141, 73);">require</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword" style="color: rgb(204, 153, 205);">let</span> path <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token function" style="color: rgb(240, 141, 73);">require</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword" style="color: rgb(204, 153, 205);">let</span> router <span class="token operator" style="color: rgb(103, 205, 204);">=</span> express<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nrouter<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">post</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'/\'</span><span class="token punctuation">,</span> <span class="token function" style="color: rgb(240, 141, 73);">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token comment" style="color: rgb(153, 153, 153);">//设置文件存储路径</span>\n     dest<span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'upload\'</span>   <span class="token comment" style="color: rgb(153, 153, 153);">//upload文件如果不存在则会自己创建一个。</span>\n <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">single</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'file\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword" style="color: rgb(204, 153, 205);">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword" style="color: rgb(204, 153, 205);">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>length <span class="token operator" style="color: rgb(103, 205, 204);">===</span> <span class="token number" style="color: rgb(240, 141, 73);">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" style="color: rgb(153, 153, 153);">//判断一下文件是否存在，也可以在前端代码中进行判断。</span>\n        res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">render</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"error"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>message<span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">"上传文件不能为空！"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword" style="color: rgb(204, 153, 205);">return</span>\n    <span class="token punctuation">}</span> <span class="token keyword" style="color: rgb(204, 153, 205);">else</span> <span class="token punctuation">{</span>\n       <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> file <span class="token operator" style="color: rgb(103, 205, 204);">=</span> req<span class="token punctuation">.</span>file<span class="token punctuation">;</span>\n       <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> fileInfo <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n       console<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>\n       fs<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">renameSync</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'./upload/\'</span> <span class="token operator" style="color: rgb(103, 205, 204);">+</span> file<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> <span class="token string" style="color: rgb(126, 198, 153);">\'./upload/\'</span> <span class="token operator" style="color: rgb(103, 205, 204);">+</span> file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" style="color: rgb(153, 153, 153);">//这里修改文件名字，比较随意。</span>\n       <span class="token comment" style="color: rgb(153, 153, 153);">// 获取文件信息</span>\n       fileInfo<span class="token punctuation">.</span>mimetype <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>mimetype<span class="token punctuation">;</span>\n       fileInfo<span class="token punctuation">.</span>originalname <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>originalname<span class="token punctuation">;</span>\n       fileInfo<span class="token punctuation">.</span>size <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>size<span class="token punctuation">;</span>\n       fileInfo<span class="token punctuation">.</span>path <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>path<span class="token punctuation">;</span>\n\n       <span class="token comment" style="color: rgb(153, 153, 153);">// 设置响应类型及编码</span>\n       res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n         <span class="token string" style="color: rgb(126, 198, 153);">\'content-type\'</span><span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'application/json; charset=utf-8\'</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n       res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">end</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"上传成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span aria-hidden="true" class="line-numbers-rows" style="position: absolute; pointer-events: none; top: 0px; left: -3.8em; width: 3em; letter-spacing: -1px; border-right: 1px solid rgb(153, 153, 153); user-select: none;"><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span></span></code></pre></div><h2 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 24px;">3、下面则是多文件的使用，记住前面说的input表单multiple属性，</h2><h4 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 20px;">(1)客户端代码和上面一样</h4><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-xml" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-xml" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;"><span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>h1</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>文件上传<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;/</span>h1</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>/<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">method</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>post<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>multipart/form-data<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n    <span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>files<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">type</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>file<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">name</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>file<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation" style="color: rgb(204, 204, 204);">/&gt;</span></span> <span class="token comment" style="color: rgb(153, 153, 153);">&lt;!-- 这里的multiple属性是允许多文件上传的,一点要写--&gt;</span>\n    <span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>submit<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span> <span class="token attr-name">value</span><span class="token attr-value" style="color: rgb(126, 198, 153);"><span class="token punctuation" style="color: rgb(204, 204, 204);">=</span><span class="token punctuation" style="color: rgb(204, 204, 204);">"</span>上传<span class="token punctuation" style="color: rgb(204, 204, 204);">"</span></span><span class="token punctuation" style="color: rgb(204, 204, 204);">/&gt;</span></span>\n<span class="token tag" style="color: rgb(226, 119, 122);"><span class="token tag"><span class="token punctuation" style="color: rgb(204, 204, 204);">&lt;/</span>form</span><span class="token punctuation" style="color: rgb(204, 204, 204);">&gt;</span></span>\n<span aria-hidden="true" class="line-numbers-rows" style="position: absolute; pointer-events: none; top: 0px; left: -3.8em; width: 3em; letter-spacing: -1px; border-right: 1px solid rgb(153, 153, 153); user-select: none;"><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span></span></code></pre></div><h4 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 20px;">(2)服务端的代码不使用single 而是使用.array("表单name属性","这里填写最大支持的文件数目")，使用方式如下</h4><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-jsx" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-jsx" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;">\nrouter<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">post</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'/\'</span><span class="token punctuation">,</span> <span class="token function" style="color: rgb(240, 141, 73);">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token comment" style="color: rgb(153, 153, 153);">//设置文件存储路径</span>\n    dest<span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'upload\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">array</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'file\'</span><span class="token punctuation">,</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword" style="color: rgb(204, 153, 205);">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" style="color: rgb(153, 153, 153);">//这里10表示最大支持的文件上传数目</span>\n    <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> files <span class="token operator" style="color: rgb(103, 205, 204);">=</span> req<span class="token punctuation">.</span>files<span class="token punctuation">;</span>\n    <span class="token keyword" style="color: rgb(204, 153, 205);">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator" style="color: rgb(103, 205, 204);">===</span> <span class="token number" style="color: rgb(240, 141, 73);">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">render</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"error"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>message<span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">"上传文件不能为空！"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword" style="color: rgb(204, 153, 205);">return</span>\n    <span class="token punctuation">}</span> <span class="token keyword" style="color: rgb(204, 153, 205);">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> fileInfos <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token keyword" style="color: rgb(204, 153, 205);">for</span> <span class="token punctuation">(</span><span class="token keyword" style="color: rgb(204, 153, 205);">var</span> i <span class="token keyword" style="color: rgb(204, 153, 205);">in</span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> file <span class="token operator" style="color: rgb(103, 205, 204);">=</span> files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> fileInfo <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n\n            fs<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">renameSync</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">\'./upload/\'</span> <span class="token operator" style="color: rgb(103, 205, 204);">+</span> file<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> <span class="token string" style="color: rgb(126, 198, 153);">\'./upload/\'</span> <span class="token operator" style="color: rgb(103, 205, 204);">+</span> file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" style="color: rgb(153, 153, 153);">//这里修改文件名。</span>\n\n            <span class="token comment" style="color: rgb(153, 153, 153);">//获取文件基本信息</span>\n            fileInfo<span class="token punctuation">.</span>mimetype <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>mimetype<span class="token punctuation">;</span>\n            fileInfo<span class="token punctuation">.</span>originalname <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>originalname<span class="token punctuation">;</span>\n            fileInfo<span class="token punctuation">.</span>size <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>size<span class="token punctuation">;</span>\n            fileInfo<span class="token punctuation">.</span>path <span class="token operator" style="color: rgb(103, 205, 204);">=</span> file<span class="token punctuation">.</span>path<span class="token punctuation">;</span>\n\n            fileInfos<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">push</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment" style="color: rgb(153, 153, 153);">// 设置响应类型及编码</span>\n        res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n            <span class="token string" style="color: rgb(126, 198, 153);">\'content-type\'</span><span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'application/json; charset=utf-8\'</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">end</span><span class="token punctuation">(</span><span class="token string" style="color: rgb(126, 198, 153);">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span aria-hidden="true" class="line-numbers-rows" style="position: absolute; pointer-events: none; top: 0px; left: -3.8em; width: 3em; letter-spacing: -1px; border-right: 1px solid rgb(153, 153, 153); user-select: none;"><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span><span style="pointer-events: none; display: block; counter-increment: linenumber 1;"></span></span></code></pre></div><h2 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 24px;">4、此时文件的简单上传实现了。当然这只是简单的进行上传，有时候还要考虑文件的大小，磁盘空间等等，当然上传文件也不只有一种，还有使用<a href="https://www.npmjs.com/package/formidable" target="_blank" rel="nofollow" style="color: rgb(6, 129, 208); background-color: transparent; outline: none; cursor: pointer; transition: color 0.3s ease 0s; touch-action: manipulation;">formidable</a>,&nbsp;<a href="https://www.npmjs.com/package/multiparty" target="_blank" rel="nofollow" style="color: rgb(6, 129, 208); background-color: transparent; outline: none; cursor: pointer; transition: color 0.3s ease 0s; touch-action: manipulation;">multiparty</a>等，有兴趣可以查看官方文档详细介绍。上传文件当然就要有下载，有时候压缩文件可以直接通过a标签下载，但是有时如果是图片，之类的浏览器会直接打开，很不友好，所以有专门的下载。</h2><h4 style="margin-top: 0px; margin-bottom: 16px; text-rendering: optimizelegibility; font-size: 20px;">4.1下载主要有两种方式，也比较简单，直接演示</h4><div class="_2Uzcx_" style="position: relative; overflow: hidden;"><button class="VJbwyy" type="button" aria-label="复制代码" style="touch-action: manipulation; margin: 0px; color: rgb(204, 204, 204); font-size: 14px; font-family: inherit; line-height: inherit; overflow: visible; cursor: pointer; user-select: none; position: absolute; top: 6px; right: 6px; display: flex; justify-content: center; align-items: center; width: 32px; height: 24px; padding: 0px; border-width: initial; border-style: none; border-color: initial; border-radius: 6px; background-color: rgba(230, 230, 230, 0.2); box-shadow: rgba(0, 0, 0, 0.25) 0px 2px 0px 0px; opacity: 1; visibility: visible; transition: opacity 0.2s ease-in-out 0s, visibility 0.2s ease-in-out 0s; z-index: 1;"><span aria-label="icon: copy" class="anticon anticon-copy" style="display: inline-block; color: inherit; line-height: 0; vertical-align: -0.125em; text-rendering: optimizelegibility; -webkit-font-smoothing: antialiased;"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></span></button><pre class="line-numbers  language-csharp" style="font-size: 12px; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; margin-top: 0px; margin-bottom: 20px; overflow: scroll auto; overflow-wrap: normal; word-break: break-all; overscroll-behavior-x: contain; border-radius: 4px; z-index: 0; padding: 1em 1em 1em 3.8em; line-height: 1.5; color: rgb(204, 204, 204); background: rgb(45, 45, 45); word-spacing: normal; tab-size: 4; hyphens: none; position: relative; counter-reset: linenumber 0;"><code class="  language-csharp" style="font-size: 1em; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; padding: 0px; border: none; vertical-align: unset; white-space: inherit; color: inherit; background: none transparent; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; position: relative;"><span class="token comment" style="color: rgb(153, 153, 153);">//第一种方式</span>\n  <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> road<span class="token operator" style="color: rgb(103, 205, 204);">=</span><span class="token string" style="color: rgb(126, 198, 153);">"这里是要下载的文件路径（可以是中文，相对路径，绝对路径等等）"</span><span class="token punctuation">;</span>\n  res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">download</span><span class="token punctuation">(</span>road<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" style="color: rgb(153, 153, 153);">//直接调用download方法即可</span>\n\n  <span class="token comment" style="color: rgb(153, 153, 153);">//第二种方式</span>\n  <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> road<span class="token operator" style="color: rgb(103, 205, 204);">=</span><span class="token string" style="color: rgb(126, 198, 153);">"这里是要下载的文件路径（可以是中文，相对路径，绝对路径等等）"</span><span class="token punctuation">;</span>\n  <span class="token keyword" style="color: rgb(204, 153, 205);">let</span> road <span class="token operator" style="color: rgb(103, 205, 204);">=</span> fs<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">createReadStream</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" style="color: rgb(153, 153, 153);">//创建输入流入口</span>\n  res<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">writeHead</span><span class="token punctuation">(</span><span class="token number" style="color: rgb(240, 141, 73);">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    <span class="token string" style="color: rgb(126, 198, 153);">\'Content-Type\'</span><span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'application/force-download\'</span><span class="token punctuation">,</span>\n    <span class="token string" style="color: rgb(126, 198, 153);">\'Content-Disposition\'</span><span class="token punctuation">:</span> <span class="token string" style="color: rgb(126, 198, 153);">\'attachment; filename=name\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  load<span class="token punctuation">.</span><span class="token function" style="color: rgb(240, 141, 73);">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" style="color: rgb(153, 153, 153);">// 通过管道方式写入</span></code></pre></div></article>',
  title: 'qqq',
  id: '23' }
[2020-03-18T20:19:43.517] [INFO] info - server running  8989port....
[2020-03-18T20:21:58.276] [INFO] info - server running  8989port....
[2020-03-18T20:23:16.122] [INFO] info - server running  8989port....
[2020-03-18T20:24:42.667] [INFO] info - server running  8989port....
[2020-03-18T20:26:01.525] [INFO] info - server running  8989port....
[2020-03-18T20:27:47.844] [INFO] info - server running  8989port....
[2020-03-18T20:29:53.878] [INFO] info - server running  8989port....
[2020-03-18T20:30:05.528] [INFO] info - server running  8989port....
[2020-03-18T20:30:41.094] [INFO] info - server running  8989port....
[2020-03-18T20:30:54.428] [INFO] info - server running  8989port....
[2020-03-18T20:32:04.505] [INFO] info - server running  8989port....
[2020-03-18T20:32:11.954] [INFO] info - server running  8989port....
[2020-03-18T20:32:27.680] [INFO] info - server running  8989port....
[2020-03-18T20:34:35.753] [INFO] info - server running  8989port....
[2020-03-18T20:35:07.054] [INFO] info - server running  8989port....
[2020-03-18T20:36:56.390] [INFO] info - server running  8989port....
[2020-03-18T20:39:17.808] [INFO] info - server running  8989port....
[2020-03-18T20:39:41.540] [INFO] info - server running  8989port....
[2020-03-18T20:53:54.164] [INFO] info - server running  8989port....
